{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _toConsumableArray from\"/Users/lara/Documents/\\u043E\\u0431\\u0443\\u0447\\u0435\\u043D\\u0438\\u0435/\\u043F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435/yaPractik/mesto-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/lara/Documents/\\u043E\\u0431\\u0443\\u0447\\u0435\\u043D\\u0438\\u0435/\\u043F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435/yaPractik/mesto-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from\"react\";import ImagePopup from\"./ImagePopup\";import Confirm from\"./Confirm\";import api from\"../utils/api\";import Header from\"./Header\";import Footer from\"./Footer\";import Main from\"./Main\";import EditProfilePopup from\"./EditProfilePopup\";import EditAvatarPopup from\"./EditAvatarPopup\";import AddPlacePopup from\"./AddPlacePopup\";import CurrentUserContext from\"../contexts/CurrentUserContext\";function App(){var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),isEditProfilePopupOpen=_React$useState2[0],setEditProfilePopupState=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),isEditAvatarPopupOpen=_React$useState4[0],setEditAvatarPopupState=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),isAddPlacePopupOpen=_React$useState6[0],setAddPlacerPopupState=_React$useState6[1];var _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),isImagePopupOpen=_React$useState8[0],setImagePopupState=_React$useState8[1];var _React$useState9=React.useState(false),_React$useState10=_slicedToArray(_React$useState9,2),isConfirmOpen=_React$useState10[0],setConfirmOpen=_React$useState10[1];var _React$useState11=React.useState([]),_React$useState12=_slicedToArray(_React$useState11,2),cards=_React$useState12[0],setCards=_React$useState12[1];var _React$useState13=React.useState(false),_React$useState14=_slicedToArray(_React$useState13,2),isLoading=_React$useState14[0],setIsLoading=_React$useState14[1];var _React$useState15=React.useState({src:\"\",nameImg:\"\"}),_React$useState16=_slicedToArray(_React$useState15,2),selectedCard=_React$useState16[0],setSelectedCard=_React$useState16[1];var _React$useState17=React.useState(false),_React$useState18=_slicedToArray(_React$useState17,2),isLoadingConfirm=_React$useState18[0],setIsLoadingConfirm=_React$useState18[1];var _React$useState19=React.useState(false),_React$useState20=_slicedToArray(_React$useState19,2),isLoadingPopup=_React$useState20[0],setIsLoadingPopup=_React$useState20[1];var _React$useState21=React.useState({name:\"\",about:\"\"}),_React$useState22=_slicedToArray(_React$useState21,2),currentUser=_React$useState22[0],setСurrentUser=_React$useState22[1];var _React$useState23=React.useState({ownerId:\"\",cardId:\"\"}),_React$useState24=_slicedToArray(_React$useState23,2),currentCard=_React$useState24[0],setСurrentCard=_React$useState24[1];var _React$useState25=React.useState({}),_React$useState26=_slicedToArray(_React$useState25,2),confirmAction=_React$useState26[0],setConfirmAction=_React$useState26[1];React.useEffect(function(){api.getUserInfo().then(function(res){setСurrentUser(res);}).catch(function(err){console.log(err);// выведем ошибку в консоль\n});},[]);function closeAllPopups(){setEditProfilePopupState(false);setEditAvatarPopupState(false);setAddPlacerPopupState(false);setImagePopupState(false);setSelectedCard([]);setIsLoadingPopup(false);setСurrentCard({ownerId:\"\",cardId:\"\"});}function handleCardClick(_ref){var src=_ref.src,nameImg=_ref.nameImg;setSelectedCard({src:src,nameImg:nameImg});setImagePopupState(true);}function handleConfirmClick(){setConfirmOpen(true);}function handleEditProfileClick(evt){evt.preventDefault();setEditProfilePopupState(true);}function handleEditAvatarClick(e){e.preventDefault();setEditAvatarPopupState(true);}function handleAddPlaceClick(evt){evt.preventDefault();setAddPlacerPopupState(true);}function cardDelete(){var isOwn=currentCard.ownerId===currentUser._id;if(isOwn){api.deleteCard(currentCard.cardId).then(function(){var newCards=cards.filter(function(c){return c.cardId!==currentCard.cardId;});setCards(newCards);}).then(function(){setConfirmOpen(false);setIsLoadingConfirm(false);}).catch(function(err){console.log(err);// выведем ошибку в консоль\n});}}function handleCardDelete(obj){setConfirmAction(\"cardDelete\");setСurrentCard({ownerId:obj.ownerId,cardId:obj.cardId});}function handleCardLike(like,cardId){// Снова проверяем, есть ли уже лайк на этой карточке\nvar isLiked=like.some(function(i){return i._id===currentUser._id;});// console.log('main -> handleCardLike');\nif(!isLiked){// console.log(\"main -> handleCardLike -> like\")\napi.likeCard(cardId).then(function(newCard){var newCards=cards.map(function(c){return c.cardId===newCard._id?{src:newCard.link,nameImg:newCard.name,like:newCard.likes,cardId:newCard._id,ownerId:newCard.owner._id}:c;});setCards(newCards);}).catch(function(err){console.log(err);// выведем ошибку в консоль\n});}else{// console.log(\"main -> handleCardLike -> deleteLike\")\napi.deleteLikeCard(cardId).then(function(newCard){var newCards=cards.map(function(c){return c.cardId===newCard._id?{src:newCard.link,nameImg:newCard.name,like:newCard.likes,cardId:newCard._id,ownerId:newCard.owner._id}:c;});setCards(newCards);}).catch(function(err){console.log(err);// выведем ошибку в консоль\n});}}function handleUpdateUser(name,about){setIsLoadingPopup(true);api.editUserInfo(name,about).then(function(res){return setСurrentUser(res);}).then(function(){setIsLoadingPopup(false);setEditProfilePopupState(false);}).catch(function(err){console.log(err);// выведем ошибку в консоль\n});}function handleUpdateAvatar(obj){setIsLoadingPopup(true);api.setUserAvatar(obj.avatar).then(function(res){return setСurrentUser(res);}).then(function(){setIsLoadingPopup(false);setEditAvatarPopupState(false);}).catch(function(err){console.log(err);// выведем ошибку в консоль\n});}function handleAddPlaceSubmit(obj){setIsLoadingPopup(true);api.addNewCard(obj.name,obj.link).then(function(newCard){newCard.key=newCard._id;newCard.like=newCard.likes;newCard.ownerId=newCard.owner._id;newCard.src=newCard.link;newCard.nameImg=newCard.name;newCard.cardId=newCard._id;setCards([newCard].concat(_toConsumableArray(cards)));}).then(function(){setIsLoadingPopup(false);setAddPlacerPopupState(false);}).catch(function(err){console.log(err);// выведем ошибку в консоль\n});}React.useEffect(function(){setIsLoading(true);api.getInitialCards().then(function(res){setCards(res.map(function(item){return{src:item.link,nameImg:item.name,like:item.likes,cardId:item._id,ownerId:item.owner._id};}));setIsLoading(false);}).catch(function(err){console.log(err);// выведем ошибку в консоль\n});},[]);return/*#__PURE__*/_jsx(CurrentUserContext.Provider,{value:currentUser,children:/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(Main,{cards:cards,onEditProfile:function onEditProfile(e){return handleEditProfileClick(e);},onEditAvatar:function onEditAvatar(e){return handleEditAvatarClick(e);},onAddPlace:function onAddPlace(e){return handleAddPlaceClick(e);},onCardClick:handleCardClick,setConfirmOpen:handleConfirmClick,onCardLike:handleCardLike,onCardDelete:handleCardDelete,isLoading:isLoading}),/*#__PURE__*/_jsx(Footer,{}),/*#__PURE__*/_jsx(EditProfilePopup,{isOpen:isEditProfilePopupOpen,onClose:closeAllPopups,onUpdateUser:handleUpdateUser,isLoadingPopup:isLoadingPopup}),/*#__PURE__*/_jsx(EditAvatarPopup,{isOpen:isEditAvatarPopupOpen,onClose:closeAllPopups,onUpdateAvatar:handleUpdateAvatar,isLoadingPopup:isLoadingPopup}),/*#__PURE__*/_jsx(AddPlacePopup,{isOpen:isAddPlacePopupOpen,onClose:closeAllPopups,onAddPlace:handleAddPlaceSubmit,isLoadingPopup:isLoadingPopup}),/*#__PURE__*/_jsx(Confirm,{isOpen:isConfirmOpen,setIsOpen:setConfirmOpen,confirmAction:confirmAction,setСurrentUser:setСurrentUser,isLoadingConfirm:isLoadingConfirm,setIsLoadingConfirm:setIsLoadingConfirm,cardDelete:cardDelete}),/*#__PURE__*/_jsx(ImagePopup,{card:selectedCard,isOpen:isImagePopupOpen,onClose:closeAllPopups})]})});}export default App;","map":{"version":3,"sources":["/Users/lara/Documents/обучение/программирование/yaPractik/mesto-react/src/components/App.js"],"names":["React","ImagePopup","Confirm","api","Header","Footer","Main","EditProfilePopup","EditAvatarPopup","AddPlacePopup","CurrentUserContext","App","useState","isEditProfilePopupOpen","setEditProfilePopupState","isEditAvatarPopupOpen","setEditAvatarPopupState","isAddPlacePopupOpen","setAddPlacerPopupState","isImagePopupOpen","setImagePopupState","isConfirmOpen","setConfirmOpen","cards","setCards","isLoading","setIsLoading","src","nameImg","selectedCard","setSelectedCard","isLoadingConfirm","setIsLoadingConfirm","isLoadingPopup","setIsLoadingPopup","name","about","currentUser","setСurrentUser","ownerId","cardId","currentCard","setСurrentCard","confirmAction","setConfirmAction","useEffect","getUserInfo","then","res","catch","err","console","log","closeAllPopups","handleCardClick","handleConfirmClick","handleEditProfileClick","evt","preventDefault","handleEditAvatarClick","e","handleAddPlaceClick","cardDelete","isOwn","_id","deleteCard","newCards","filter","c","handleCardDelete","obj","handleCardLike","like","isLiked","some","i","likeCard","newCard","map","link","likes","owner","deleteLikeCard","handleUpdateUser","editUserInfo","handleUpdateAvatar","setUserAvatar","avatar","handleAddPlaceSubmit","addNewCard","key","getInitialCards","item"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport ImagePopup from \"./ImagePopup\";\nimport Confirm from \"./Confirm\";\nimport api from \"../utils/api\";\n\nimport Header from \"./Header\";\nimport Footer from \"./Footer\";\nimport Main from \"./Main\";\nimport EditProfilePopup from \"./EditProfilePopup\";\nimport EditAvatarPopup from \"./EditAvatarPopup\";\nimport AddPlacePopup from \"./AddPlacePopup\";\n\nimport CurrentUserContext from \"../contexts/CurrentUserContext\";\n\nfunction App() {\n  const [isEditProfilePopupOpen, setEditProfilePopupState] = React.useState(\n    false\n  );\n  const [isEditAvatarPopupOpen, setEditAvatarPopupState] = React.useState(\n    false\n  );\n  const [isAddPlacePopupOpen, setAddPlacerPopupState] = React.useState(false);\n  const [isImagePopupOpen, setImagePopupState] = React.useState(false);\n  const [isConfirmOpen, setConfirmOpen] = React.useState(false);\n\n  const [cards, setCards] = React.useState([]);\n  const [isLoading, setIsLoading] = React.useState(false);\n  const [selectedCard, setSelectedCard] = React.useState({\n    src: \"\",\n    nameImg: \"\",\n  });\n  const [isLoadingConfirm, setIsLoadingConfirm] = React.useState(false);\n  const [isLoadingPopup, setIsLoadingPopup] = React.useState(false);\n\n  const [currentUser, setСurrentUser] = React.useState({ name: \"\", about: \"\" });\n  const [currentCard, setСurrentCard] = React.useState({\n    ownerId: \"\",\n    cardId: \"\",\n  });\n\n  const [confirmAction, setConfirmAction] = React.useState({});\n\n  React.useEffect(() => {\n    api\n      .getUserInfo()\n      .then((res) => {\n        setСurrentUser(res);\n      })\n      .catch((err) => {\n        console.log(err); // выведем ошибку в консоль\n      });\n  }, []);\n\n  function closeAllPopups() {\n    setEditProfilePopupState(false);\n    setEditAvatarPopupState(false);\n    setAddPlacerPopupState(false);\n    setImagePopupState(false);\n    setSelectedCard([]);\n    setIsLoadingPopup(false);\n    setСurrentCard({\n      ownerId: \"\",\n      cardId: \"\",\n    });\n  }\n\n  function handleCardClick({ src, nameImg }) {\n    setSelectedCard({ src, nameImg });\n    setImagePopupState(true);\n  }\n\n  function handleConfirmClick() {\n    setConfirmOpen(true);\n  }\n\n  function handleEditProfileClick(evt) {\n    evt.preventDefault();\n    setEditProfilePopupState(true);\n  }\n\n  function handleEditAvatarClick(e) {\n    e.preventDefault();\n    setEditAvatarPopupState(true);\n  }\n\n  function handleAddPlaceClick(evt) {\n    evt.preventDefault();\n    setAddPlacerPopupState(true);\n  }\n\n  function cardDelete() {\n    const isOwn = currentCard.ownerId === currentUser._id;\n    if (isOwn) {\n      api\n        .deleteCard(currentCard.cardId)\n        .then(() => {\n          const newCards = cards.filter((c) => c.cardId !== currentCard.cardId);\n          setCards(newCards);\n        })\n        .then(() => {\n          setConfirmOpen(false);\n          setIsLoadingConfirm(false);\n        })\n        .catch((err) => {\n          console.log(err); // выведем ошибку в консоль\n        });\n    }\n  }\n\n  function handleCardDelete(obj) {\n    setConfirmAction(\"cardDelete\");\n    setСurrentCard({\n      ownerId: obj.ownerId,\n      cardId: obj.cardId,\n    });\n  }\n\n  function handleCardLike(like, cardId) {\n    // Снова проверяем, есть ли уже лайк на этой карточке\n    const isLiked = like.some((i) => i._id === currentUser._id);\n    // console.log('main -> handleCardLike');\n    if (!isLiked) {\n      // console.log(\"main -> handleCardLike -> like\")\n      api\n        .likeCard(cardId)\n        .then((newCard) => {\n          const newCards = cards.map((c) =>\n            c.cardId === newCard._id\n              ? {\n                  src: newCard.link,\n                  nameImg: newCard.name,\n                  like: newCard.likes,\n                  cardId: newCard._id,\n                  ownerId: newCard.owner._id,\n                }\n              : c\n          );\n          setCards(newCards);\n        })\n        .catch((err) => {\n          console.log(err); // выведем ошибку в консоль\n        });\n    } else {\n      // console.log(\"main -> handleCardLike -> deleteLike\")\n      api\n        .deleteLikeCard(cardId)\n        .then((newCard) => {\n          const newCards = cards.map((c) =>\n            c.cardId === newCard._id\n              ? {\n                  src: newCard.link,\n                  nameImg: newCard.name,\n                  like: newCard.likes,\n                  cardId: newCard._id,\n                  ownerId: newCard.owner._id,\n                }\n              : c\n          );\n          setCards(newCards);\n        })\n        .catch((err) => {\n          console.log(err); // выведем ошибку в консоль\n        });\n    }\n  }\n\n  function handleUpdateUser(name, about) {\n    setIsLoadingPopup(true);\n    api\n      .editUserInfo(name, about)\n      .then((res) => setСurrentUser(res))\n      .then(() => {\n        setIsLoadingPopup(false);\n        setEditProfilePopupState(false);\n      })\n      .catch((err) => {\n        console.log(err); // выведем ошибку в консоль\n      });\n  }\n\n  function handleUpdateAvatar(obj) {\n    setIsLoadingPopup(true);\n    api\n      .setUserAvatar(obj.avatar)\n      .then((res) => setСurrentUser(res))\n      .then(() => {\n        setIsLoadingPopup(false);\n        setEditAvatarPopupState(false);\n      })\n      .catch((err) => {\n        console.log(err); // выведем ошибку в консоль\n      });\n  }\n\n  function handleAddPlaceSubmit(obj) {\n    setIsLoadingPopup(true);\n    api\n      .addNewCard(obj.name, obj.link)\n      .then((newCard) => {\n        newCard.key = newCard._id;\n        newCard.like = newCard.likes;\n        newCard.ownerId = newCard.owner._id;\n        newCard.src = newCard.link;\n        newCard.nameImg = newCard.name;\n        newCard.cardId = newCard._id;\n        setCards([newCard, ...cards]);\n      })\n      .then(() => {\n        setIsLoadingPopup(false);\n        setAddPlacerPopupState(false);\n      })\n      .catch((err) => {\n        console.log(err); // выведем ошибку в консоль\n      });\n  }\n\n  React.useEffect(() => {\n    setIsLoading(true);\n    api\n      .getInitialCards()\n      .then((res) => {\n        setCards(\n          res.map((item) => ({\n            src: item.link,\n            nameImg: item.name,\n            like: item.likes,\n            cardId: item._id,\n            ownerId: item.owner._id,\n          }))\n        );\n        setIsLoading(false);\n      })\n      .catch((err) => {\n        console.log(err); // выведем ошибку в консоль\n      });\n  }, []);\n\n  return (\n    <CurrentUserContext.Provider value={currentUser}>\n      <div className=\"App\">\n        <Header />\n        <Main\n          cards={cards}\n          onEditProfile={(e) => handleEditProfileClick(e)}\n          onEditAvatar={(e) => handleEditAvatarClick(e)}\n          onAddPlace={(e) => handleAddPlaceClick(e)}\n          onCardClick={handleCardClick}\n          setConfirmOpen={handleConfirmClick}\n          onCardLike={handleCardLike}\n          onCardDelete={handleCardDelete}\n          isLoading={isLoading}\n        />\n        <Footer />\n\n        <EditProfilePopup\n          isOpen={isEditProfilePopupOpen}\n          onClose={closeAllPopups}\n          onUpdateUser={handleUpdateUser}\n          isLoadingPopup={isLoadingPopup}\n        ></EditProfilePopup>\n        <EditAvatarPopup\n          isOpen={isEditAvatarPopupOpen}\n          onClose={closeAllPopups}\n          onUpdateAvatar={handleUpdateAvatar}\n          isLoadingPopup={isLoadingPopup}\n        ></EditAvatarPopup>\n        <AddPlacePopup\n          isOpen={isAddPlacePopupOpen}\n          onClose={closeAllPopups}\n          onAddPlace={handleAddPlaceSubmit}\n          isLoadingPopup={isLoadingPopup}\n        ></AddPlacePopup>\n\n        <Confirm\n          isOpen={isConfirmOpen}\n          setIsOpen={setConfirmOpen}\n          confirmAction={confirmAction}\n          setСurrentUser={setСurrentUser}\n          isLoadingConfirm={isLoadingConfirm}\n          setIsLoadingConfirm={setIsLoadingConfirm}\n          cardDelete={cardDelete}\n        />\n        <ImagePopup\n          card={selectedCard}\n          isOpen={isImagePopupOpen}\n          onClose={closeAllPopups}\n        />\n      </div>\n    </CurrentUserContext.Provider>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}