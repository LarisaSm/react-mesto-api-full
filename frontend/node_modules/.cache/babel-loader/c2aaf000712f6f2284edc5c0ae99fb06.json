{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/lara/Documents/\\u043E\\u0431\\u0443\\u0447\\u0435\\u043D\\u0438\\u0435/\\u043F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435/yaPractik/mesto-react/src/components/App.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport ImagePopup from \"./ImagePopup\";\nimport Confirm from \"./Confirm\";\nimport api from \"../utils/api\";\nimport Header from \"./Header\";\nimport Footer from \"./Footer\";\nimport Main from \"./Main\";\nimport EditProfilePopup from \"./EditProfilePopup\";\nimport EditAvatarPopup from \"./EditAvatarPopup\";\nimport AddPlacePopup from \"./AddPlacePopup\";\nimport CurrentUserContext from \"../contexts/CurrentUserContext\";\n\nfunction App() {\n  _s();\n\n  const [isEditProfilePopupOpen, setEditProfilePopupState] = React.useState(false);\n  const [isEditAvatarPopupOpen, setEditAvatarPopupState] = React.useState(false);\n  const [isAddPlacePopupOpen, setAddPlacerPopupState] = React.useState(false);\n  const [isImagePopupOpen, setImagePopupState] = React.useState(false);\n  const [isConfirmOpen, setConfirmOpen] = React.useState(false);\n  const [cards, setCards] = React.useState([]);\n  const [isLoading, setIsLoading] = React.useState(false);\n  const [selectedCard, setSelectedCard] = React.useState({\n    src: \"\",\n    nameImg: \"\"\n  });\n  const [isLoadingConfirm, setIsLoadingConfirm] = React.useState(false);\n  const [isLoadingPopup, setIsLoadingPopup] = React.useState(false);\n  const [currentUser, setСurrentUser] = React.useState({\n    name: \"\",\n    about: \"\"\n  });\n  const [currentCard, setСurrentCard] = React.useState({\n    ownerId: \"\",\n    cardId: \"\"\n  });\n  const [confirmAction, setConfirmAction] = React.useState({});\n  const [confirmObj, setConfirmObj] = React.useState({\n    name: \"\",\n    about: \"\"\n  });\n  React.useEffect(() => {\n    api.getUserInfo().then(res => {\n      setСurrentUser(res);\n    }).catch(err => {\n      console.log(err); // выведем ошибку в консоль\n    });\n  }, []);\n\n  function closeAllPopups() {\n    setEditProfilePopupState(false);\n    setEditAvatarPopupState(false);\n    setAddPlacerPopupState(false);\n    setImagePopupState(false);\n    setSelectedCard([]);\n  }\n\n  function handleCardClick({\n    src,\n    nameImg\n  }) {\n    setSelectedCard({\n      src,\n      nameImg\n    });\n    setImagePopupState(true);\n  }\n\n  function handleConfirmClick() {\n    setConfirmOpen(true);\n  }\n\n  function handleEditProfileClick(evt) {\n    evt.preventDefault();\n    setEditProfilePopupState(true);\n  }\n\n  function handleEditAvatarClick(e) {\n    e.preventDefault();\n    setEditAvatarPopupState(true);\n  }\n\n  function handleAddPlaceClick(evt) {\n    evt.preventDefault();\n    setAddPlacerPopupState(true);\n  }\n\n  function cardDelete() {\n    console.log(currentCard); // const isOwn = obj.ownerId === currentUser._id;\n    // if (isOwn) {\n    //   api\n    //     .deleteCard(obj.cardId)\n    //     .then(() => {\n    //       const newCards = cards.filter((c) => c.cardId !== obj.cardId);\n    //       setCards(newCards);\n    //     })\n    //     .then(() => {\n    //       setConfirmOpen(false);\n    //     })\n    //     .catch((err) => {\n    //       console.log(err); // выведем ошибку в консоль\n    //     });\n    // }\n  }\n\n  function handleCardDelete(obj) {\n    setConfirmAction(\"cardDelete\");\n    setСurrentCard({\n      ownerId: obj.ownerId,\n      cardId: obj.cardId\n    });\n  }\n\n  function handleCardLike(like, cardId) {\n    // Снова проверяем, есть ли уже лайк на этой карточке\n    const isLiked = like.some(i => i._id === currentUser._id); // console.log('main -> handleCardLike');\n\n    if (!isLiked) {\n      // console.log(\"main -> handleCardLike -> like\")\n      api.likeCard(cardId).then(newCard => {\n        const newCards = cards.map(c => c.cardId === newCard._id ? {\n          src: newCard.link,\n          nameImg: newCard.name,\n          like: newCard.likes,\n          cardId: newCard._id,\n          ownerId: newCard.owner._id\n        } : c);\n        setCards(newCards);\n      }).catch(err => {\n        console.log(err); // выведем ошибку в консоль\n      });\n    } else {\n      // console.log(\"main -> handleCardLike -> deleteLike\")\n      api.deleteLikeCard(cardId).then(newCard => {\n        const newCards = cards.map(c => c.cardId === newCard._id ? {\n          src: newCard.link,\n          nameImg: newCard.name,\n          like: newCard.likes,\n          cardId: newCard._id,\n          ownerId: newCard.owner._id\n        } : c);\n        setCards(newCards);\n      }).catch(err => {\n        console.log(err); // выведем ошибку в консоль\n      });\n    }\n  }\n\n  function handleUpdateUser(name, about) {\n    setIsLoadingPopup(true);\n    api.editUserInfo(name, about).then(res => setСurrentUser(res)).then(() => {\n      setIsLoadingPopup(false);\n      setEditProfilePopupState(false);\n    }).catch(err => {\n      console.log(err); // выведем ошибку в консоль\n    });\n  }\n\n  function handleUpdateAvatar(obj) {\n    setIsLoadingPopup(true);\n    api.setUserAvatar(obj.avatar).then(res => setСurrentUser(res)).then(() => {\n      setIsLoadingPopup(false);\n      setEditAvatarPopupState(false);\n    }).catch(err => {\n      console.log(err); // выведем ошибку в консоль\n    });\n  }\n\n  function handleAddPlaceSubmit(obj) {\n    setIsLoadingPopup(true);\n    api.addNewCard(obj.name, obj.link).then(newCard => {\n      newCard.key = newCard._id;\n      newCard.like = newCard.likes;\n      newCard.ownerId = newCard.owner._id;\n      newCard.src = newCard.link;\n      newCard.nameImg = newCard.name;\n      newCard.cardId = newCard._id;\n      setCards([newCard, ...cards]);\n    }).then(() => {\n      setIsLoadingPopup(false);\n      setAddPlacerPopupState(false);\n    }).catch(err => {\n      console.log(err); // выведем ошибку в консоль\n    });\n  }\n\n  React.useEffect(() => {\n    setIsLoading(true);\n    api.getInitialCards().then(res => {\n      setCards(res.map(item => ({\n        src: item.link,\n        nameImg: item.name,\n        like: item.likes,\n        cardId: item._id,\n        ownerId: item.owner._id\n      })));\n      setIsLoading(false);\n    }).catch(err => {\n      console.log(err); // выведем ошибку в консоль\n    });\n  }, []);\n  return /*#__PURE__*/_jsxDEV(CurrentUserContext.Provider, {\n    value: currentUser,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App\",\n      children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Main, {\n        cards: cards,\n        onEditProfile: e => handleEditProfileClick(e),\n        onEditAvatar: e => handleEditAvatarClick(e),\n        onAddPlace: e => handleAddPlaceClick(e),\n        onCardClick: handleCardClick,\n        setConfirmOpen: handleConfirmClick,\n        setConfirmAction: setConfirmAction,\n        setConfirmObj: setConfirmObj,\n        onCardLike: handleCardLike,\n        onCardDelete: handleCardDelete,\n        isLoading: isLoading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(EditProfilePopup, {\n        isOpen: isEditProfilePopupOpen,\n        onClose: closeAllPopups,\n        onUpdateUser: handleUpdateUser,\n        isLoadingPopup: isLoadingPopup\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(EditAvatarPopup, {\n        isOpen: isEditAvatarPopupOpen,\n        onClose: closeAllPopups,\n        onUpdateAvatar: handleUpdateAvatar,\n        isLoadingPopup: isLoadingPopup\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(AddPlacePopup, {\n        isOpen: isAddPlacePopupOpen,\n        onClose: closeAllPopups,\n        onAddPlace: handleAddPlaceSubmit,\n        isLoadingPopup: isLoadingPopup\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Confirm, {\n        isOpen: isConfirmOpen,\n        setIsOpen: setConfirmOpen,\n        confirmAction: confirmAction,\n        confirmObj: confirmObj,\n        setСurrentUser: setСurrentUser,\n        cards: cards,\n        setCards: setCards,\n        isLoadingConfirm: isLoadingConfirm,\n        setIsLoadingConfirm: setIsLoadingConfirm,\n        cardDelete: cardDelete\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ImagePopup, {\n        card: selectedCard,\n        isOpen: isImagePopupOpen,\n        onClose: closeAllPopups\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 236,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"mSW/36+KmsBwWnRnUc5C30VZjN8=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/Users/lara/Documents/обучение/программирование/yaPractik/mesto-react/src/components/App.js"],"names":["React","ImagePopup","Confirm","api","Header","Footer","Main","EditProfilePopup","EditAvatarPopup","AddPlacePopup","CurrentUserContext","App","isEditProfilePopupOpen","setEditProfilePopupState","useState","isEditAvatarPopupOpen","setEditAvatarPopupState","isAddPlacePopupOpen","setAddPlacerPopupState","isImagePopupOpen","setImagePopupState","isConfirmOpen","setConfirmOpen","cards","setCards","isLoading","setIsLoading","selectedCard","setSelectedCard","src","nameImg","isLoadingConfirm","setIsLoadingConfirm","isLoadingPopup","setIsLoadingPopup","currentUser","setСurrentUser","name","about","currentCard","setСurrentCard","ownerId","cardId","confirmAction","setConfirmAction","confirmObj","setConfirmObj","useEffect","getUserInfo","then","res","catch","err","console","log","closeAllPopups","handleCardClick","handleConfirmClick","handleEditProfileClick","evt","preventDefault","handleEditAvatarClick","e","handleAddPlaceClick","cardDelete","handleCardDelete","obj","handleCardLike","like","isLiked","some","i","_id","likeCard","newCard","newCards","map","c","link","likes","owner","deleteLikeCard","handleUpdateUser","editUserInfo","handleUpdateAvatar","setUserAvatar","avatar","handleAddPlaceSubmit","addNewCard","key","getInitialCards","item"],"mappings":";;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,UAAP,MAAuB,cAAvB;AACA,OAAOC,OAAP,MAAoB,WAApB;AACA,OAAOC,GAAP,MAAgB,cAAhB;AAEA,OAAOC,MAAP,MAAmB,UAAnB;AACA,OAAOC,MAAP,MAAmB,UAAnB;AACA,OAAOC,IAAP,MAAiB,QAAjB;AACA,OAAOC,gBAAP,MAA6B,oBAA7B;AACA,OAAOC,eAAP,MAA4B,mBAA5B;AACA,OAAOC,aAAP,MAA0B,iBAA1B;AAEA,OAAOC,kBAAP,MAA+B,gCAA/B;;AAEA,SAASC,GAAT,GAAe;AAAA;;AACb,QAAM,CAACC,sBAAD,EAAyBC,wBAAzB,IAAqDb,KAAK,CAACc,QAAN,CACzD,KADyD,CAA3D;AAGA,QAAM,CAACC,qBAAD,EAAwBC,uBAAxB,IAAmDhB,KAAK,CAACc,QAAN,CACvD,KADuD,CAAzD;AAGA,QAAM,CAACG,mBAAD,EAAsBC,sBAAtB,IAAgDlB,KAAK,CAACc,QAAN,CAAe,KAAf,CAAtD;AACA,QAAM,CAACK,gBAAD,EAAmBC,kBAAnB,IAAyCpB,KAAK,CAACc,QAAN,CAAe,KAAf,CAA/C;AACA,QAAM,CAACO,aAAD,EAAgBC,cAAhB,IAAkCtB,KAAK,CAACc,QAAN,CAAe,KAAf,CAAxC;AAEA,QAAM,CAACS,KAAD,EAAQC,QAAR,IAAoBxB,KAAK,CAACc,QAAN,CAAe,EAAf,CAA1B;AACA,QAAM,CAACW,SAAD,EAAYC,YAAZ,IAA4B1B,KAAK,CAACc,QAAN,CAAe,KAAf,CAAlC;AACA,QAAM,CAACa,YAAD,EAAeC,eAAf,IAAkC5B,KAAK,CAACc,QAAN,CAAe;AACrDe,IAAAA,GAAG,EAAE,EADgD;AAErDC,IAAAA,OAAO,EAAE;AAF4C,GAAf,CAAxC;AAIA,QAAM,CAACC,gBAAD,EAAmBC,mBAAnB,IAA0ChC,KAAK,CAACc,QAAN,CAAe,KAAf,CAAhD;AACA,QAAM,CAACmB,cAAD,EAAiBC,iBAAjB,IAAsClC,KAAK,CAACc,QAAN,CAAe,KAAf,CAA5C;AAEA,QAAM,CAACqB,WAAD,EAAcC,cAAd,IAAgCpC,KAAK,CAACc,QAAN,CAAe;AAAEuB,IAAAA,IAAI,EAAE,EAAR;AAAYC,IAAAA,KAAK,EAAE;AAAnB,GAAf,CAAtC;AACA,QAAM,CAACC,WAAD,EAAcC,cAAd,IAAgCxC,KAAK,CAACc,QAAN,CAAe;AACnD2B,IAAAA,OAAO,EAAE,EAD0C;AAEnDC,IAAAA,MAAM,EAAE;AAF2C,GAAf,CAAtC;AAKA,QAAM,CAACC,aAAD,EAAgBC,gBAAhB,IAAoC5C,KAAK,CAACc,QAAN,CAAe,EAAf,CAA1C;AACA,QAAM,CAAC+B,UAAD,EAAaC,aAAb,IAA8B9C,KAAK,CAACc,QAAN,CAAe;AAAEuB,IAAAA,IAAI,EAAE,EAAR;AAAYC,IAAAA,KAAK,EAAE;AAAnB,GAAf,CAApC;AAEAtC,EAAAA,KAAK,CAAC+C,SAAN,CAAgB,MAAM;AACpB5C,IAAAA,GAAG,CACA6C,WADH,GAEGC,IAFH,CAESC,GAAD,IAAS;AACbd,MAAAA,cAAc,CAACc,GAAD,CAAd;AACD,KAJH,EAKGC,KALH,CAKUC,GAAD,IAAS;AACdC,MAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ,EADc,CACI;AACnB,KAPH;AAQD,GATD,EASG,EATH;;AAWA,WAASG,cAAT,GAA0B;AACxB1C,IAAAA,wBAAwB,CAAC,KAAD,CAAxB;AACAG,IAAAA,uBAAuB,CAAC,KAAD,CAAvB;AACAE,IAAAA,sBAAsB,CAAC,KAAD,CAAtB;AACAE,IAAAA,kBAAkB,CAAC,KAAD,CAAlB;AACAQ,IAAAA,eAAe,CAAC,EAAD,CAAf;AACD;;AAED,WAAS4B,eAAT,CAAyB;AAAE3B,IAAAA,GAAF;AAAOC,IAAAA;AAAP,GAAzB,EAA2C;AACzCF,IAAAA,eAAe,CAAC;AAAEC,MAAAA,GAAF;AAAOC,MAAAA;AAAP,KAAD,CAAf;AACAV,IAAAA,kBAAkB,CAAC,IAAD,CAAlB;AACD;;AAED,WAASqC,kBAAT,GAA8B;AAC5BnC,IAAAA,cAAc,CAAC,IAAD,CAAd;AACD;;AAED,WAASoC,sBAAT,CAAgCC,GAAhC,EAAqC;AACnCA,IAAAA,GAAG,CAACC,cAAJ;AACA/C,IAAAA,wBAAwB,CAAC,IAAD,CAAxB;AACD;;AAED,WAASgD,qBAAT,CAA+BC,CAA/B,EAAkC;AAChCA,IAAAA,CAAC,CAACF,cAAF;AACA5C,IAAAA,uBAAuB,CAAC,IAAD,CAAvB;AACD;;AAED,WAAS+C,mBAAT,CAA6BJ,GAA7B,EAAkC;AAChCA,IAAAA,GAAG,CAACC,cAAJ;AACA1C,IAAAA,sBAAsB,CAAC,IAAD,CAAtB;AACD;;AAED,WAAS8C,UAAT,GAAsB;AACpBX,IAAAA,OAAO,CAACC,GAAR,CAAYf,WAAZ,EADoB,CAGpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD;;AAED,WAAS0B,gBAAT,CAA0BC,GAA1B,EAA+B;AAC7BtB,IAAAA,gBAAgB,CAAC,YAAD,CAAhB;AACAJ,IAAAA,cAAc,CAAC;AACbC,MAAAA,OAAO,EAAEyB,GAAG,CAACzB,OADA;AAEbC,MAAAA,MAAM,EAAEwB,GAAG,CAACxB;AAFC,KAAD,CAAd;AAID;;AAED,WAASyB,cAAT,CAAwBC,IAAxB,EAA8B1B,MAA9B,EAAsC;AACpC;AACA,UAAM2B,OAAO,GAAGD,IAAI,CAACE,IAAL,CAAWC,CAAD,IAAOA,CAAC,CAACC,GAAF,KAAUrC,WAAW,CAACqC,GAAvC,CAAhB,CAFoC,CAGpC;;AACA,QAAI,CAACH,OAAL,EAAc;AACZ;AACAlE,MAAAA,GAAG,CACAsE,QADH,CACY/B,MADZ,EAEGO,IAFH,CAESyB,OAAD,IAAa;AACjB,cAAMC,QAAQ,GAAGpD,KAAK,CAACqD,GAAN,CAAWC,CAAD,IACzBA,CAAC,CAACnC,MAAF,KAAagC,OAAO,CAACF,GAArB,GACI;AACE3C,UAAAA,GAAG,EAAE6C,OAAO,CAACI,IADf;AAEEhD,UAAAA,OAAO,EAAE4C,OAAO,CAACrC,IAFnB;AAGE+B,UAAAA,IAAI,EAAEM,OAAO,CAACK,KAHhB;AAIErC,UAAAA,MAAM,EAAEgC,OAAO,CAACF,GAJlB;AAKE/B,UAAAA,OAAO,EAAEiC,OAAO,CAACM,KAAR,CAAcR;AALzB,SADJ,GAQIK,CATW,CAAjB;AAWArD,QAAAA,QAAQ,CAACmD,QAAD,CAAR;AACD,OAfH,EAgBGxB,KAhBH,CAgBUC,GAAD,IAAS;AACdC,QAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ,EADc,CACI;AACnB,OAlBH;AAmBD,KArBD,MAqBO;AACL;AACAjD,MAAAA,GAAG,CACA8E,cADH,CACkBvC,MADlB,EAEGO,IAFH,CAESyB,OAAD,IAAa;AACjB,cAAMC,QAAQ,GAAGpD,KAAK,CAACqD,GAAN,CAAWC,CAAD,IACzBA,CAAC,CAACnC,MAAF,KAAagC,OAAO,CAACF,GAArB,GACI;AACE3C,UAAAA,GAAG,EAAE6C,OAAO,CAACI,IADf;AAEEhD,UAAAA,OAAO,EAAE4C,OAAO,CAACrC,IAFnB;AAGE+B,UAAAA,IAAI,EAAEM,OAAO,CAACK,KAHhB;AAIErC,UAAAA,MAAM,EAAEgC,OAAO,CAACF,GAJlB;AAKE/B,UAAAA,OAAO,EAAEiC,OAAO,CAACM,KAAR,CAAcR;AALzB,SADJ,GAQIK,CATW,CAAjB;AAWArD,QAAAA,QAAQ,CAACmD,QAAD,CAAR;AACD,OAfH,EAgBGxB,KAhBH,CAgBUC,GAAD,IAAS;AACdC,QAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ,EADc,CACI;AACnB,OAlBH;AAmBD;AACF;;AAED,WAAS8B,gBAAT,CAA0B7C,IAA1B,EAAgCC,KAAhC,EAAuC;AACrCJ,IAAAA,iBAAiB,CAAC,IAAD,CAAjB;AACA/B,IAAAA,GAAG,CACAgF,YADH,CACgB9C,IADhB,EACsBC,KADtB,EAEGW,IAFH,CAESC,GAAD,IAASd,cAAc,CAACc,GAAD,CAF/B,EAGGD,IAHH,CAGQ,MAAM;AACVf,MAAAA,iBAAiB,CAAC,KAAD,CAAjB;AACArB,MAAAA,wBAAwB,CAAC,KAAD,CAAxB;AACD,KANH,EAOGsC,KAPH,CAOUC,GAAD,IAAS;AACdC,MAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ,EADc,CACI;AACnB,KATH;AAUD;;AAED,WAASgC,kBAAT,CAA4BlB,GAA5B,EAAiC;AAC/BhC,IAAAA,iBAAiB,CAAC,IAAD,CAAjB;AACA/B,IAAAA,GAAG,CACAkF,aADH,CACiBnB,GAAG,CAACoB,MADrB,EAEGrC,IAFH,CAESC,GAAD,IAASd,cAAc,CAACc,GAAD,CAF/B,EAGGD,IAHH,CAGQ,MAAM;AACVf,MAAAA,iBAAiB,CAAC,KAAD,CAAjB;AACAlB,MAAAA,uBAAuB,CAAC,KAAD,CAAvB;AACD,KANH,EAOGmC,KAPH,CAOUC,GAAD,IAAS;AACdC,MAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ,EADc,CACI;AACnB,KATH;AAUD;;AAED,WAASmC,oBAAT,CAA8BrB,GAA9B,EAAmC;AACjChC,IAAAA,iBAAiB,CAAC,IAAD,CAAjB;AACA/B,IAAAA,GAAG,CACAqF,UADH,CACctB,GAAG,CAAC7B,IADlB,EACwB6B,GAAG,CAACY,IAD5B,EAEG7B,IAFH,CAESyB,OAAD,IAAa;AACjBA,MAAAA,OAAO,CAACe,GAAR,GAAcf,OAAO,CAACF,GAAtB;AACAE,MAAAA,OAAO,CAACN,IAAR,GAAeM,OAAO,CAACK,KAAvB;AACAL,MAAAA,OAAO,CAACjC,OAAR,GAAkBiC,OAAO,CAACM,KAAR,CAAcR,GAAhC;AACAE,MAAAA,OAAO,CAAC7C,GAAR,GAAc6C,OAAO,CAACI,IAAtB;AACAJ,MAAAA,OAAO,CAAC5C,OAAR,GAAkB4C,OAAO,CAACrC,IAA1B;AACAqC,MAAAA,OAAO,CAAChC,MAAR,GAAiBgC,OAAO,CAACF,GAAzB;AACAhD,MAAAA,QAAQ,CAAC,CAACkD,OAAD,EAAU,GAAGnD,KAAb,CAAD,CAAR;AACD,KAVH,EAWG0B,IAXH,CAWQ,MAAM;AACVf,MAAAA,iBAAiB,CAAC,KAAD,CAAjB;AACAhB,MAAAA,sBAAsB,CAAC,KAAD,CAAtB;AACD,KAdH,EAeGiC,KAfH,CAeUC,GAAD,IAAS;AACdC,MAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ,EADc,CACI;AACnB,KAjBH;AAkBD;;AAEDpD,EAAAA,KAAK,CAAC+C,SAAN,CAAgB,MAAM;AACpBrB,IAAAA,YAAY,CAAC,IAAD,CAAZ;AACAvB,IAAAA,GAAG,CACAuF,eADH,GAEGzC,IAFH,CAESC,GAAD,IAAS;AACb1B,MAAAA,QAAQ,CACN0B,GAAG,CAAC0B,GAAJ,CAASe,IAAD,KAAW;AACjB9D,QAAAA,GAAG,EAAE8D,IAAI,CAACb,IADO;AAEjBhD,QAAAA,OAAO,EAAE6D,IAAI,CAACtD,IAFG;AAGjB+B,QAAAA,IAAI,EAAEuB,IAAI,CAACZ,KAHM;AAIjBrC,QAAAA,MAAM,EAAEiD,IAAI,CAACnB,GAJI;AAKjB/B,QAAAA,OAAO,EAAEkD,IAAI,CAACX,KAAL,CAAWR;AALH,OAAX,CAAR,CADM,CAAR;AASA9C,MAAAA,YAAY,CAAC,KAAD,CAAZ;AACD,KAbH,EAcGyB,KAdH,CAcUC,GAAD,IAAS;AACdC,MAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ,EADc,CACI;AACnB,KAhBH;AAiBD,GAnBD,EAmBG,EAnBH;AAqBA,sBACE,QAAC,kBAAD,CAAoB,QAApB;AAA6B,IAAA,KAAK,EAAEjB,WAApC;AAAA,2BACE;AAAK,MAAA,SAAS,EAAC,KAAf;AAAA,8BACE,QAAC,MAAD;AAAA;AAAA;AAAA;AAAA,cADF,eAEE,QAAC,IAAD;AACE,QAAA,KAAK,EAAEZ,KADT;AAEE,QAAA,aAAa,EAAGuC,CAAD,IAAOJ,sBAAsB,CAACI,CAAD,CAF9C;AAGE,QAAA,YAAY,EAAGA,CAAD,IAAOD,qBAAqB,CAACC,CAAD,CAH5C;AAIE,QAAA,UAAU,EAAGA,CAAD,IAAOC,mBAAmB,CAACD,CAAD,CAJxC;AAKE,QAAA,WAAW,EAAEN,eALf;AAME,QAAA,cAAc,EAAEC,kBANlB;AAOE,QAAA,gBAAgB,EAAEb,gBAPpB;AAQE,QAAA,aAAa,EAAEE,aARjB;AASE,QAAA,UAAU,EAAEqB,cATd;AAUE,QAAA,YAAY,EAAEF,gBAVhB;AAWE,QAAA,SAAS,EAAExC;AAXb;AAAA;AAAA;AAAA;AAAA,cAFF,eAeE,QAAC,MAAD;AAAA;AAAA;AAAA;AAAA,cAfF,eAiBE,QAAC,gBAAD;AACE,QAAA,MAAM,EAAEb,sBADV;AAEE,QAAA,OAAO,EAAE2C,cAFX;AAGE,QAAA,YAAY,EAAE2B,gBAHhB;AAIE,QAAA,cAAc,EAAEjD;AAJlB;AAAA;AAAA;AAAA;AAAA,cAjBF,eAuBE,QAAC,eAAD;AACE,QAAA,MAAM,EAAElB,qBADV;AAEE,QAAA,OAAO,EAAEwC,cAFX;AAGE,QAAA,cAAc,EAAE6B,kBAHlB;AAIE,QAAA,cAAc,EAAEnD;AAJlB;AAAA;AAAA;AAAA;AAAA,cAvBF,eA6BE,QAAC,aAAD;AACE,QAAA,MAAM,EAAEhB,mBADV;AAEE,QAAA,OAAO,EAAEsC,cAFX;AAGE,QAAA,UAAU,EAAEgC,oBAHd;AAIE,QAAA,cAAc,EAAEtD;AAJlB;AAAA;AAAA;AAAA;AAAA,cA7BF,eAoCE,QAAC,OAAD;AACE,QAAA,MAAM,EAAEZ,aADV;AAEE,QAAA,SAAS,EAAEC,cAFb;AAGE,QAAA,aAAa,EAAEqB,aAHjB;AAIE,QAAA,UAAU,EAAEE,UAJd;AAKE,QAAA,cAAc,EAAET,cALlB;AAME,QAAA,KAAK,EAAEb,KANT;AAOE,QAAA,QAAQ,EAAEC,QAPZ;AAQE,QAAA,gBAAgB,EAAEO,gBARpB;AASE,QAAA,mBAAmB,EAAEC,mBATvB;AAUE,QAAA,UAAU,EAAEgC;AAVd;AAAA;AAAA;AAAA;AAAA,cApCF,eAgDE,QAAC,UAAD;AACE,QAAA,IAAI,EAAErC,YADR;AAEE,QAAA,MAAM,EAAER,gBAFV;AAGE,QAAA,OAAO,EAAEoC;AAHX;AAAA;AAAA;AAAA;AAAA,cAhDF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,UADF;AA0DD;;GAtRQ5C,G;;KAAAA,G;AAwRT,eAAeA,GAAf","sourcesContent":["import React from \"react\";\nimport ImagePopup from \"./ImagePopup\";\nimport Confirm from \"./Confirm\";\nimport api from \"../utils/api\";\n\nimport Header from \"./Header\";\nimport Footer from \"./Footer\";\nimport Main from \"./Main\";\nimport EditProfilePopup from \"./EditProfilePopup\";\nimport EditAvatarPopup from \"./EditAvatarPopup\";\nimport AddPlacePopup from \"./AddPlacePopup\";\n\nimport CurrentUserContext from \"../contexts/CurrentUserContext\";\n\nfunction App() {\n  const [isEditProfilePopupOpen, setEditProfilePopupState] = React.useState(\n    false\n  );\n  const [isEditAvatarPopupOpen, setEditAvatarPopupState] = React.useState(\n    false\n  );\n  const [isAddPlacePopupOpen, setAddPlacerPopupState] = React.useState(false);\n  const [isImagePopupOpen, setImagePopupState] = React.useState(false);\n  const [isConfirmOpen, setConfirmOpen] = React.useState(false);\n\n  const [cards, setCards] = React.useState([]);\n  const [isLoading, setIsLoading] = React.useState(false);\n  const [selectedCard, setSelectedCard] = React.useState({\n    src: \"\",\n    nameImg: \"\",\n  });\n  const [isLoadingConfirm, setIsLoadingConfirm] = React.useState(false);\n  const [isLoadingPopup, setIsLoadingPopup] = React.useState(false);\n\n  const [currentUser, setСurrentUser] = React.useState({ name: \"\", about: \"\" });\n  const [currentCard, setСurrentCard] = React.useState({\n    ownerId: \"\",\n    cardId: \"\",\n  });\n\n  const [confirmAction, setConfirmAction] = React.useState({});\n  const [confirmObj, setConfirmObj] = React.useState({ name: \"\", about: \"\" });\n\n  React.useEffect(() => {\n    api\n      .getUserInfo()\n      .then((res) => {\n        setСurrentUser(res);\n      })\n      .catch((err) => {\n        console.log(err); // выведем ошибку в консоль\n      });\n  }, []);\n\n  function closeAllPopups() {\n    setEditProfilePopupState(false);\n    setEditAvatarPopupState(false);\n    setAddPlacerPopupState(false);\n    setImagePopupState(false);\n    setSelectedCard([]);\n  }\n\n  function handleCardClick({ src, nameImg }) {\n    setSelectedCard({ src, nameImg });\n    setImagePopupState(true);\n  }\n\n  function handleConfirmClick() {\n    setConfirmOpen(true);\n  }\n\n  function handleEditProfileClick(evt) {\n    evt.preventDefault();\n    setEditProfilePopupState(true);\n  }\n\n  function handleEditAvatarClick(e) {\n    e.preventDefault();\n    setEditAvatarPopupState(true);\n  }\n\n  function handleAddPlaceClick(evt) {\n    evt.preventDefault();\n    setAddPlacerPopupState(true);\n  }\n\n  function cardDelete() {\n    console.log(currentCard);\n\n    // const isOwn = obj.ownerId === currentUser._id;\n    // if (isOwn) {\n    //   api\n    //     .deleteCard(obj.cardId)\n    //     .then(() => {\n    //       const newCards = cards.filter((c) => c.cardId !== obj.cardId);\n    //       setCards(newCards);\n    //     })\n    //     .then(() => {\n    //       setConfirmOpen(false);\n    //     })\n    //     .catch((err) => {\n    //       console.log(err); // выведем ошибку в консоль\n    //     });\n    // }\n  }\n\n  function handleCardDelete(obj) {\n    setConfirmAction(\"cardDelete\");\n    setСurrentCard({\n      ownerId: obj.ownerId,\n      cardId: obj.cardId,\n    });\n  }\n\n  function handleCardLike(like, cardId) {\n    // Снова проверяем, есть ли уже лайк на этой карточке\n    const isLiked = like.some((i) => i._id === currentUser._id);\n    // console.log('main -> handleCardLike');\n    if (!isLiked) {\n      // console.log(\"main -> handleCardLike -> like\")\n      api\n        .likeCard(cardId)\n        .then((newCard) => {\n          const newCards = cards.map((c) =>\n            c.cardId === newCard._id\n              ? {\n                  src: newCard.link,\n                  nameImg: newCard.name,\n                  like: newCard.likes,\n                  cardId: newCard._id,\n                  ownerId: newCard.owner._id,\n                }\n              : c\n          );\n          setCards(newCards);\n        })\n        .catch((err) => {\n          console.log(err); // выведем ошибку в консоль\n        });\n    } else {\n      // console.log(\"main -> handleCardLike -> deleteLike\")\n      api\n        .deleteLikeCard(cardId)\n        .then((newCard) => {\n          const newCards = cards.map((c) =>\n            c.cardId === newCard._id\n              ? {\n                  src: newCard.link,\n                  nameImg: newCard.name,\n                  like: newCard.likes,\n                  cardId: newCard._id,\n                  ownerId: newCard.owner._id,\n                }\n              : c\n          );\n          setCards(newCards);\n        })\n        .catch((err) => {\n          console.log(err); // выведем ошибку в консоль\n        });\n    }\n  }\n\n  function handleUpdateUser(name, about) {\n    setIsLoadingPopup(true);\n    api\n      .editUserInfo(name, about)\n      .then((res) => setСurrentUser(res))\n      .then(() => {\n        setIsLoadingPopup(false);\n        setEditProfilePopupState(false);\n      })\n      .catch((err) => {\n        console.log(err); // выведем ошибку в консоль\n      });\n  }\n\n  function handleUpdateAvatar(obj) {\n    setIsLoadingPopup(true);\n    api\n      .setUserAvatar(obj.avatar)\n      .then((res) => setСurrentUser(res))\n      .then(() => {\n        setIsLoadingPopup(false);\n        setEditAvatarPopupState(false);\n      })\n      .catch((err) => {\n        console.log(err); // выведем ошибку в консоль\n      });\n  }\n\n  function handleAddPlaceSubmit(obj) {\n    setIsLoadingPopup(true);\n    api\n      .addNewCard(obj.name, obj.link)\n      .then((newCard) => {\n        newCard.key = newCard._id;\n        newCard.like = newCard.likes;\n        newCard.ownerId = newCard.owner._id;\n        newCard.src = newCard.link;\n        newCard.nameImg = newCard.name;\n        newCard.cardId = newCard._id;\n        setCards([newCard, ...cards]);\n      })\n      .then(() => {\n        setIsLoadingPopup(false);\n        setAddPlacerPopupState(false);\n      })\n      .catch((err) => {\n        console.log(err); // выведем ошибку в консоль\n      });\n  }\n\n  React.useEffect(() => {\n    setIsLoading(true);\n    api\n      .getInitialCards()\n      .then((res) => {\n        setCards(\n          res.map((item) => ({\n            src: item.link,\n            nameImg: item.name,\n            like: item.likes,\n            cardId: item._id,\n            ownerId: item.owner._id,\n          }))\n        );\n        setIsLoading(false);\n      })\n      .catch((err) => {\n        console.log(err); // выведем ошибку в консоль\n      });\n  }, []);\n\n  return (\n    <CurrentUserContext.Provider value={currentUser}>\n      <div className=\"App\">\n        <Header />\n        <Main\n          cards={cards}\n          onEditProfile={(e) => handleEditProfileClick(e)}\n          onEditAvatar={(e) => handleEditAvatarClick(e)}\n          onAddPlace={(e) => handleAddPlaceClick(e)}\n          onCardClick={handleCardClick}\n          setConfirmOpen={handleConfirmClick}\n          setConfirmAction={setConfirmAction}\n          setConfirmObj={setConfirmObj}\n          onCardLike={handleCardLike}\n          onCardDelete={handleCardDelete}\n          isLoading={isLoading}\n        />\n        <Footer />\n\n        <EditProfilePopup\n          isOpen={isEditProfilePopupOpen}\n          onClose={closeAllPopups}\n          onUpdateUser={handleUpdateUser}\n          isLoadingPopup={isLoadingPopup}\n        ></EditProfilePopup>\n        <EditAvatarPopup\n          isOpen={isEditAvatarPopupOpen}\n          onClose={closeAllPopups}\n          onUpdateAvatar={handleUpdateAvatar}\n          isLoadingPopup={isLoadingPopup}\n        ></EditAvatarPopup>\n        <AddPlacePopup\n          isOpen={isAddPlacePopupOpen}\n          onClose={closeAllPopups}\n          onAddPlace={handleAddPlaceSubmit}\n          isLoadingPopup={isLoadingPopup}\n        ></AddPlacePopup>\n\n        <Confirm\n          isOpen={isConfirmOpen}\n          setIsOpen={setConfirmOpen}\n          confirmAction={confirmAction}\n          confirmObj={confirmObj}\n          setСurrentUser={setСurrentUser}\n          cards={cards}\n          setCards={setCards}\n          isLoadingConfirm={isLoadingConfirm}\n          setIsLoadingConfirm={setIsLoadingConfirm}\n          cardDelete={cardDelete}\n        />\n        <ImagePopup\n          card={selectedCard}\n          isOpen={isImagePopupOpen}\n          onClose={closeAllPopups}\n        />\n      </div>\n    </CurrentUserContext.Provider>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}