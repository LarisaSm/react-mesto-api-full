{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/lara/Documents/\\u043E\\u0431\\u0443\\u0447\\u0435\\u043D\\u0438\\u0435/\\u043F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435/yaPractik/mesto-all/frontend/src/components/App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useCallback } from \"react\";\nimport ImagePopup from \"./ImagePopup\";\nimport Confirm from \"./Confirm\";\nimport { getInitialCards, addNewCard, editUserInfo, getUserInfo, deleteCard, likeCard, deleteLikeCard, getLikesCard, setUserAvatar } from \"../utils/api\";\nimport Login from \"./Login\";\nimport Register from \"./Register\";\nimport ProtectedRoute from \"./ProtectedRoute\";\nimport PageNotFound from \"./PageNotFound\";\nimport * as auth from \"../utils/auth\";\nimport InfoTooltip from \"./InfoTooltip\";\nimport { Route, Switch, useHistory } from \"react-router-dom\";\nimport Header from \"./Header\";\nimport Footer from \"./Footer\";\nimport Main from \"./Main\";\nimport EditProfilePopup from \"./EditProfilePopup\";\nimport EditAvatarPopup from \"./EditAvatarPopup\";\nimport AddPlacePopup from \"./AddPlacePopup\";\nimport CurrentUserContext from \"../contexts/CurrentUserContext\";\n\nfunction App() {\n  _s();\n\n  const [isEditProfilePopupOpen, setEditProfilePopupState] = React.useState(false);\n  const [isEditAvatarPopupOpen, setEditAvatarPopupState] = React.useState(false);\n  const [isAddPlacePopupOpen, setAddPlacerPopupState] = React.useState(false);\n  const [isImagePopupOpen, setImagePopupState] = React.useState(false);\n  const [isConfirmOpen, setConfirmOpen] = React.useState(false);\n  const [isInfoTooltipOpen, setInfoTooltipOpen] = React.useState(false);\n  const [isConfirmAuth, setConfirmAuth] = React.useState(false);\n  const [cards, setCards] = React.useState([]);\n  const [isLoading, setIsLoading] = React.useState(false);\n  const [selectedCard, setSelectedCard] = React.useState({\n    src: \"\",\n    nameImg: \"\"\n  });\n  const [isLoadingConfirm, setIsLoadingConfirm] = React.useState(false);\n  const [isLoadingPopup, setIsLoadingPopup] = React.useState(false);\n  const [currentUser, setСurrentUser] = React.useState({\n    name: \"\",\n    about: \"\",\n    email: \"\",\n    token: \"\"\n  });\n  const [currentUserHeaders, setCurrentUserHeaders] = React.useState({\n    authorization: \"\"\n  });\n  const [currentCard, setСurrentCard] = React.useState({\n    ownerId: \"\",\n    cardId: \"\"\n  });\n  const [userData, setUserData] = React.useState({});\n  const [confirmAction, setConfirmAction] = React.useState({});\n  const history = useHistory();\n  const [loggedIn, setLoggedIn] = React.useState(false); // React.useEffect(() => {\n  //   console.log('123123123123');\n  //   tokenCheck();\n  //   console.log()\n  // }, []);\n\n  React.useEffect(() => {\n    api.getUserInfo(currentUserHeaders).then(res => {\n      setСurrentUser(res);\n    }).catch(err => {\n      console.log(err); // выведем ошибку в консоль\n    });\n  }, [currentUserHeaders]);\n\n  function closeAllPopups() {\n    setEditProfilePopupState(false);\n    setEditAvatarPopupState(false);\n    setAddPlacerPopupState(false);\n    setImagePopupState(false);\n    setInfoTooltipOpen(false);\n    setSelectedCard([]);\n    setIsLoadingPopup(false);\n    setСurrentCard({\n      ownerId: \"\",\n      cardId: \"\"\n    });\n  }\n\n  function handleCardClick({\n    src,\n    nameImg\n  }) {\n    setSelectedCard({\n      src,\n      nameImg\n    });\n    setImagePopupState(true);\n  }\n\n  function handleConfirmClick() {\n    setConfirmOpen(true);\n  }\n\n  function handleEditProfileClick(evt) {\n    evt.preventDefault();\n    setEditProfilePopupState(true);\n  }\n\n  function handleEditAvatarClick(e) {\n    e.preventDefault();\n    setEditAvatarPopupState(true);\n  }\n\n  function handleAddPlaceClick(evt) {\n    evt.preventDefault();\n    setAddPlacerPopupState(true);\n  }\n\n  function cardDelete() {\n    const isOwn = currentCard.ownerId === currentUser._id;\n\n    if (isOwn) {\n      api.deleteCard(currentCard.cardId).then(() => {\n        const newCards = cards.filter(c => c.cardId !== currentCard.cardId);\n        setCards(newCards);\n      }).then(() => {\n        setConfirmOpen(false);\n        setIsLoadingConfirm(false);\n      }).catch(err => {\n        console.log(err); // выведем ошибку в консоль\n      });\n    }\n  }\n\n  function handleCardDelete(obj) {\n    setConfirmAction(\"cardDelete\");\n    setСurrentCard({\n      ownerId: obj.ownerId,\n      cardId: obj.cardId\n    });\n  }\n\n  function handleCardLike(like, cardId) {\n    // Снова проверяем, есть ли уже лайк на этой карточке\n    const isLiked = like.some(i => i._id === currentUser._id); // console.log('main -> handleCardLike');\n\n    if (!isLiked) {\n      // console.log(\"main -> handleCardLike -> like\")\n      api.likeCard(cardId).then(newCard => {\n        const newCards = cards.map(c => c.cardId === newCard._id ? {\n          src: newCard.link,\n          nameImg: newCard.name,\n          like: newCard.likes,\n          cardId: newCard._id,\n          ownerId: newCard.owner._id\n        } : c);\n        setCards(newCards);\n      }).catch(err => {\n        console.log(err); // выведем ошибку в консоль\n      });\n    } else {\n      // console.log(\"main -> handleCardLike -> deleteLike\")\n      api.deleteLikeCard(cardId).then(newCard => {\n        const newCards = cards.map(c => c.cardId === newCard._id ? {\n          src: newCard.link,\n          nameImg: newCard.name,\n          like: newCard.likes,\n          cardId: newCard._id,\n          ownerId: newCard.owner._id\n        } : c);\n        setCards(newCards);\n      }).catch(err => {\n        console.log(err); // выведем ошибку в консоль\n      });\n    }\n  }\n\n  function handleUpdateUser(name, about) {\n    setIsLoadingPopup(true);\n    api.editUserInfo(name, about).then(res => setСurrentUser(res)).then(() => {\n      setIsLoadingPopup(false);\n      setEditProfilePopupState(false);\n    }).catch(err => {\n      console.log(err); // выведем ошибку в консоль\n    });\n  }\n\n  function handleUpdateAvatar(obj) {\n    setIsLoadingPopup(true);\n    api.setUserAvatar(obj.avatar).then(res => setСurrentUser(res)).then(() => {\n      setIsLoadingPopup(false);\n      setEditAvatarPopupState(false);\n    }).catch(err => {\n      console.log(err); // выведем ошибку в консоль\n    });\n  }\n\n  function handleAddPlaceSubmit(obj) {\n    setIsLoadingPopup(true);\n    api.addNewCard(obj.name, obj.link).then(newCard => {\n      newCard.key = newCard._id;\n      newCard.like = newCard.likes;\n      newCard.ownerId = newCard.owner._id;\n      newCard.src = newCard.link;\n      newCard.nameImg = newCard.name;\n      newCard.cardId = newCard._id;\n      setCards([newCard, ...cards]);\n    }).then(() => {\n      setIsLoadingPopup(false);\n      setAddPlacerPopupState(false);\n    }).catch(err => {\n      console.log(err); // выведем ошибку в консоль\n    });\n  }\n\n  function handleLogin(inputEmailValue, inputPassValue) {\n    auth.authorize(inputPassValue, inputEmailValue).then(data => {\n      if (data.token) {\n        setLoggedIn(true); // setUserData({ email: inputEmailValue });\n\n        setСurrentUser({\n          email: inputEmailValue\n        });\n        setCurrentUserHeaders({\n          authorization: data.token\n        });\n        console.log('app=>handleLogin');\n        console.log(currentUserHeaders);\n        history.push(\"/\");\n      }\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  function handleRegister(inputPassValue, inputEmailValue) {\n    auth.register(inputPassValue, inputEmailValue).then(data => {\n      if (data._id) {\n        setConfirmAuth(true);\n        history.push(\"/sign-in\");\n      }\n\n      setInfoTooltipOpen(true);\n    }).catch(err => {\n      console.log(err);\n      setConfirmAuth(false);\n      setInfoTooltipOpen(true);\n    });\n  }\n\n  function signOut() {\n    localStorage.removeItem(\"jwt\");\n    history.push(\"/sign-in\");\n  }\n\n  const tokenCheck = useCallback(() => {\n    // если у пользователя есть токен в localStorage,\n    // эта функция проверит валидность токена\n    const jwt = localStorage.getItem(\"jwt\");\n    console.log(`tokencheck ${jwt}`);\n\n    if (jwt) {\n      console.log(\"app=>tokencheck=>if\");\n      console.log(jwt); // проверим токен\n\n      auth.getContent(jwt).then(res => {\n        console.log(\"app=>tokencheck\");\n        console.log(res);\n\n        if (res) {\n          // авторизуем пользователя\n          setLoggedIn(true); // setUserData({ email: res.data.email });\n\n          setСurrentUser({\n            email: res.data.email\n          });\n          setCurrentUserHeaders({\n            authorization: jwt\n          });\n          console.log(currentUserHeaders); // обернём App.js в withRouter\n          // так, что теперь есть доступ к этому методу\n\n          history.push(\"/\");\n        }\n      }).catch(err => {\n        console.log(err); // выведем ошибку в консоль\n      });\n    }\n  }, []);\n  React.useEffect(() => {\n    setIsLoading(true);\n    tokenCheck();\n    console.log(\"useEffect=>getInitialCards\");\n    console.log(currentUserHeaders);\n    api.getInitialCards(currentUserHeaders).then(res => {\n      console.log(currentUserHeaders);\n      setCards(res.map(item => ({\n        src: item.link,\n        nameImg: item.name,\n        like: item.likes,\n        cardId: item._id,\n        ownerId: item.owner._id\n      })));\n      setIsLoading(false);\n    }).catch(err => {\n      console.log(err); // выведем ошибку в консоль\n    });\n  }, [currentUserHeaders, tokenCheck]);\n  return /*#__PURE__*/_jsxDEV(CurrentUserContext.Provider, {\n    value: currentUser,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App\",\n      children: [/*#__PURE__*/_jsxDEV(Header, {\n        loggedIn: loggedIn,\n        userData: currentUser,\n        signOut: signOut\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 347,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Switch, {\n        children: [/*#__PURE__*/_jsxDEV(ProtectedRoute, {\n          exact: true,\n          path: \"/\",\n          component: Main,\n          loggedIn: loggedIn,\n          cards: cards,\n          onEditProfile: e => handleEditProfileClick(e),\n          onEditAvatar: e => handleEditAvatarClick(e),\n          onAddPlace: e => handleAddPlaceClick(e),\n          onCardClick: handleCardClick,\n          setConfirmOpen: handleConfirmClick,\n          onCardLike: handleCardLike,\n          onCardDelete: handleCardDelete,\n          isLoading: isLoading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 349,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/sign-in\",\n          children: /*#__PURE__*/_jsxDEV(Login, {\n            onLogin: handleLogin\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 365,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 364,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/sign-up\",\n          children: /*#__PURE__*/_jsxDEV(Register, {\n            onRegister: handleRegister\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 368,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 367,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"*\",\n          children: /*#__PURE__*/_jsxDEV(PageNotFound, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 374,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 373,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 348,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 378,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(EditProfilePopup, {\n        isOpen: isEditProfilePopupOpen,\n        onClose: closeAllPopups,\n        onUpdateUser: handleUpdateUser,\n        isLoadingPopup: isLoadingPopup\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(EditAvatarPopup, {\n        isOpen: isEditAvatarPopupOpen,\n        onClose: closeAllPopups,\n        onUpdateAvatar: handleUpdateAvatar,\n        isLoadingPopup: isLoadingPopup\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 386,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(AddPlacePopup, {\n        isOpen: isAddPlacePopupOpen,\n        onClose: closeAllPopups,\n        onAddPlace: handleAddPlaceSubmit,\n        isLoadingPopup: isLoadingPopup\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 392,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Confirm, {\n        isOpen: isConfirmOpen,\n        setIsOpen: setConfirmOpen,\n        confirmAction: confirmAction,\n        setСurrentUser: setСurrentUser,\n        isLoadingConfirm: isLoadingConfirm,\n        setIsLoadingConfirm: setIsLoadingConfirm,\n        cardDelete: cardDelete\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 399,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ImagePopup, {\n        card: selectedCard,\n        isOpen: isImagePopupOpen,\n        onClose: closeAllPopups\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 408,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(InfoTooltip, {\n        isOpen: isInfoTooltipOpen,\n        onClose: closeAllPopups,\n        isConfirmAuth: isConfirmAuth\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 413,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 345,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"GWRUCOngfotHuZZN0pJjpOfNkBg=\", false, function () {\n  return [useHistory];\n});\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/Users/lara/Documents/обучение/программирование/yaPractik/mesto-all/frontend/src/components/App.js"],"names":["React","useCallback","ImagePopup","Confirm","getInitialCards","addNewCard","editUserInfo","getUserInfo","deleteCard","likeCard","deleteLikeCard","getLikesCard","setUserAvatar","Login","Register","ProtectedRoute","PageNotFound","auth","InfoTooltip","Route","Switch","useHistory","Header","Footer","Main","EditProfilePopup","EditAvatarPopup","AddPlacePopup","CurrentUserContext","App","isEditProfilePopupOpen","setEditProfilePopupState","useState","isEditAvatarPopupOpen","setEditAvatarPopupState","isAddPlacePopupOpen","setAddPlacerPopupState","isImagePopupOpen","setImagePopupState","isConfirmOpen","setConfirmOpen","isInfoTooltipOpen","setInfoTooltipOpen","isConfirmAuth","setConfirmAuth","cards","setCards","isLoading","setIsLoading","selectedCard","setSelectedCard","src","nameImg","isLoadingConfirm","setIsLoadingConfirm","isLoadingPopup","setIsLoadingPopup","currentUser","setСurrentUser","name","about","email","token","currentUserHeaders","setCurrentUserHeaders","authorization","currentCard","setСurrentCard","ownerId","cardId","userData","setUserData","confirmAction","setConfirmAction","history","loggedIn","setLoggedIn","useEffect","api","then","res","catch","err","console","log","closeAllPopups","handleCardClick","handleConfirmClick","handleEditProfileClick","evt","preventDefault","handleEditAvatarClick","e","handleAddPlaceClick","cardDelete","isOwn","_id","newCards","filter","c","handleCardDelete","obj","handleCardLike","like","isLiked","some","i","newCard","map","link","likes","owner","handleUpdateUser","handleUpdateAvatar","avatar","handleAddPlaceSubmit","key","handleLogin","inputEmailValue","inputPassValue","authorize","data","push","handleRegister","register","signOut","localStorage","removeItem","tokenCheck","jwt","getItem","getContent","item"],"mappings":"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","sourcesContent":["import React, { useCallback } from \"react\";\nimport ImagePopup from \"./ImagePopup\";\nimport Confirm from \"./Confirm\";\nimport { getInitialCards, addNewCard, editUserInfo, getUserInfo, deleteCard, likeCard, deleteLikeCard,getLikesCard, setUserAvatar } from \"../utils/api\";\nimport Login from \"./Login\";\nimport Register from \"./Register\";\nimport ProtectedRoute from \"./ProtectedRoute\";\nimport PageNotFound from \"./PageNotFound\";\nimport * as auth from \"../utils/auth\";\nimport InfoTooltip from \"./InfoTooltip\";\n\nimport { Route, Switch, useHistory } from \"react-router-dom\";\nimport Header from \"./Header\";\nimport Footer from \"./Footer\";\nimport Main from \"./Main\";\nimport EditProfilePopup from \"./EditProfilePopup\";\nimport EditAvatarPopup from \"./EditAvatarPopup\";\nimport AddPlacePopup from \"./AddPlacePopup\";\n\nimport CurrentUserContext from \"../contexts/CurrentUserContext\";\n\nfunction App() {\n\n  const [isEditProfilePopupOpen, setEditProfilePopupState] = React.useState(\n    false\n  );\n  const [isEditAvatarPopupOpen, setEditAvatarPopupState] = React.useState(\n    false\n  );\n  const [isAddPlacePopupOpen, setAddPlacerPopupState] = React.useState(false);\n  const [isImagePopupOpen, setImagePopupState] = React.useState(false);\n  const [isConfirmOpen, setConfirmOpen] = React.useState(false);\n  const [isInfoTooltipOpen, setInfoTooltipOpen] = React.useState(false);\n  const [isConfirmAuth, setConfirmAuth] = React.useState(false);\n\n  const [cards, setCards] = React.useState([]);\n  const [isLoading, setIsLoading] = React.useState(false);\n  const [selectedCard, setSelectedCard] = React.useState({\n    src: \"\",\n    nameImg: \"\",\n  });\n  const [isLoadingConfirm, setIsLoadingConfirm] = React.useState(false);\n  const [isLoadingPopup, setIsLoadingPopup] = React.useState(false);\n\n  const [currentUser, setСurrentUser] = React.useState({ name: \"\", about: \"\", email: \"\", token: \"\" });\n  const [currentUserHeaders, setCurrentUserHeaders] = React.useState({ authorization: \"\" });\n\n  const [currentCard, setСurrentCard] = React.useState({\n    ownerId: \"\",\n    cardId: \"\",\n  });\n\n  const [userData, setUserData] = React.useState({});\n\n  const [confirmAction, setConfirmAction] = React.useState({});\n\n  const history = useHistory();\n\n  const [loggedIn, setLoggedIn] = React.useState(false);\n\n\n  // React.useEffect(() => {\n  //   console.log('123123123123');\n  //   tokenCheck();\n  //   console.log()\n  // }, []);\n\n  React.useEffect(() => {\n    api\n      .getUserInfo(currentUserHeaders)\n      .then((res) => {\n        setСurrentUser(res);\n      })\n      .catch((err) => {\n        console.log(err); // выведем ошибку в консоль\n      });\n  }, [currentUserHeaders]);\n\n\n\n  function closeAllPopups() {\n    setEditProfilePopupState(false);\n    setEditAvatarPopupState(false);\n    setAddPlacerPopupState(false);\n    setImagePopupState(false);\n    setInfoTooltipOpen(false);\n    setSelectedCard([]);\n    setIsLoadingPopup(false);\n    setСurrentCard({\n      ownerId: \"\",\n      cardId: \"\",\n    });\n  }\n\n  function handleCardClick({ src, nameImg }) {\n    setSelectedCard({ src, nameImg });\n    setImagePopupState(true);\n  }\n\n  function handleConfirmClick() {\n    setConfirmOpen(true);\n  }\n\n  function handleEditProfileClick(evt) {\n    evt.preventDefault();\n    setEditProfilePopupState(true);\n  }\n\n  function handleEditAvatarClick(e) {\n    e.preventDefault();\n    setEditAvatarPopupState(true);\n  }\n\n  function handleAddPlaceClick(evt) {\n    evt.preventDefault();\n    setAddPlacerPopupState(true);\n  }\n\n  function cardDelete() {\n    const isOwn = currentCard.ownerId === currentUser._id;\n    if (isOwn) {\n      api\n        .deleteCard(currentCard.cardId)\n        .then(() => {\n          const newCards = cards.filter((c) => c.cardId !== currentCard.cardId);\n          setCards(newCards);\n        })\n        .then(() => {\n          setConfirmOpen(false);\n          setIsLoadingConfirm(false);\n        })\n        .catch((err) => {\n          console.log(err); // выведем ошибку в консоль\n        });\n    }\n  }\n\n  function handleCardDelete(obj) {\n    setConfirmAction(\"cardDelete\");\n    setСurrentCard({\n      ownerId: obj.ownerId,\n      cardId: obj.cardId,\n    });\n  }\n\n  function handleCardLike(like, cardId) {\n    // Снова проверяем, есть ли уже лайк на этой карточке\n    const isLiked = like.some((i) => i._id === currentUser._id);\n    // console.log('main -> handleCardLike');\n    if (!isLiked) {\n      // console.log(\"main -> handleCardLike -> like\")\n      api\n        .likeCard(cardId)\n        .then((newCard) => {\n          const newCards = cards.map((c) =>\n            c.cardId === newCard._id\n              ? {\n                  src: newCard.link,\n                  nameImg: newCard.name,\n                  like: newCard.likes,\n                  cardId: newCard._id,\n                  ownerId: newCard.owner._id,\n                }\n              : c\n          );\n          setCards(newCards);\n        })\n        .catch((err) => {\n          console.log(err); // выведем ошибку в консоль\n        });\n    } else {\n      // console.log(\"main -> handleCardLike -> deleteLike\")\n      api\n        .deleteLikeCard(cardId)\n        .then((newCard) => {\n          const newCards = cards.map((c) =>\n            c.cardId === newCard._id\n              ? {\n                  src: newCard.link,\n                  nameImg: newCard.name,\n                  like: newCard.likes,\n                  cardId: newCard._id,\n                  ownerId: newCard.owner._id,\n                }\n              : c\n          );\n          setCards(newCards);\n        })\n        .catch((err) => {\n          console.log(err); // выведем ошибку в консоль\n        });\n    }\n  }\n\n  function handleUpdateUser(name, about) {\n    setIsLoadingPopup(true);\n    api\n      .editUserInfo(name, about)\n      .then((res) => setСurrentUser(res))\n      .then(() => {\n        setIsLoadingPopup(false);\n        setEditProfilePopupState(false);\n      })\n      .catch((err) => {\n        console.log(err); // выведем ошибку в консоль\n      });\n  }\n\n  function handleUpdateAvatar(obj) {\n    setIsLoadingPopup(true);\n    api\n      .setUserAvatar(obj.avatar)\n      .then((res) => setСurrentUser(res))\n      .then(() => {\n        setIsLoadingPopup(false);\n        setEditAvatarPopupState(false);\n      })\n      .catch((err) => {\n        console.log(err); // выведем ошибку в консоль\n      });\n  }\n\n  function handleAddPlaceSubmit(obj) {\n    setIsLoadingPopup(true);\n    api\n      .addNewCard(obj.name, obj.link)\n      .then((newCard) => {\n        newCard.key = newCard._id;\n        newCard.like = newCard.likes;\n        newCard.ownerId = newCard.owner._id;\n        newCard.src = newCard.link;\n        newCard.nameImg = newCard.name;\n        newCard.cardId = newCard._id;\n        setCards([newCard, ...cards]);\n      })\n      .then(() => {\n        setIsLoadingPopup(false);\n        setAddPlacerPopupState(false);\n      })\n      .catch((err) => {\n        console.log(err); // выведем ошибку в консоль\n      });\n  }\n\n  function handleLogin(inputEmailValue, inputPassValue) {\n    auth\n      .authorize(inputPassValue, inputEmailValue)\n      .then((data) => {\n        if (data.token) {\n          setLoggedIn(true);\n          // setUserData({ email: inputEmailValue });\n          setСurrentUser({ email: inputEmailValue });\n          setCurrentUserHeaders({authorization: data.token});\n          console.log('app=>handleLogin');\n          console.log(currentUserHeaders);\n          history.push(\"/\");\n        }\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }\n\n  function handleRegister(inputPassValue, inputEmailValue) {\n    auth\n      .register(inputPassValue, inputEmailValue)\n      .then((data) => {\n        if (data._id) {\n          setConfirmAuth(true);\n          history.push(\"/sign-in\");\n        }\n        setInfoTooltipOpen(true);\n      })\n      .catch((err) => {\n        console.log(err);\n        setConfirmAuth(false);\n        setInfoTooltipOpen(true);\n      });\n  }\n\n  function signOut() {\n    localStorage.removeItem(\"jwt\");\n    history.push(\"/sign-in\");\n  }\n\n  const tokenCheck = useCallback(() => {\n    // если у пользователя есть токен в localStorage,\n    // эта функция проверит валидность токена\n    const jwt = localStorage.getItem(\"jwt\");\n    console.log(`tokencheck ${jwt}`);\n    if (jwt) {\n      console.log(\"app=>tokencheck=>if\");\n      console.log(jwt);\n      // проверим токен\n      auth\n        .getContent(jwt)\n        .then((res) => {\n          console.log(\"app=>tokencheck\");\n          console.log(res);\n          if (res) {\n            // авторизуем пользователя\n            setLoggedIn(true);\n            // setUserData({ email: res.data.email });\n            setСurrentUser({ email: res.data.email });\n            setCurrentUserHeaders({authorization: jwt});\n            console.log(currentUserHeaders);\n            \n            // обернём App.js в withRouter\n            // так, что теперь есть доступ к этому методу\n            history.push(\"/\");\n          }\n        })\n        .catch((err) => {\n          console.log(err); // выведем ошибку в консоль\n        });\n    }\n  }, [])\n\n  React.useEffect(() => {\n    setIsLoading(true);\n    tokenCheck();\n    console.log(\"useEffect=>getInitialCards\");\n    console.log(currentUserHeaders);\n    api\n      .getInitialCards(currentUserHeaders)\n      .then((res) => {\n        console.log(currentUserHeaders);\n        setCards(\n          res.map((item) => ({\n            src: item.link,\n            nameImg: item.name,\n            like: item.likes,\n            cardId: item._id,\n            ownerId: item.owner._id,\n          }))\n        );\n        setIsLoading(false);\n      })\n      .catch((err) => {\n        console.log(err); // выведем ошибку в консоль\n      });\n  }, [currentUserHeaders, tokenCheck]);\n\n  return (\n    <CurrentUserContext.Provider value={currentUser}>\n      <div className=\"App\">\n        <Header loggedIn={loggedIn} userData={currentUser} signOut={signOut} />\n        <Switch>\n          <ProtectedRoute\n            exact\n            path=\"/\"\n            component={Main}\n            loggedIn={loggedIn}\n            cards={cards}\n            onEditProfile={(e) => handleEditProfileClick(e)}\n            onEditAvatar={(e) => handleEditAvatarClick(e)}\n            onAddPlace={(e) => handleAddPlaceClick(e)}\n            onCardClick={handleCardClick}\n            setConfirmOpen={handleConfirmClick}\n            onCardLike={handleCardLike}\n            onCardDelete={handleCardDelete}\n            isLoading={isLoading}\n          />\n          <Route path=\"/sign-in\">\n            <Login onLogin={handleLogin} />\n          </Route>\n          <Route path=\"/sign-up\">\n            <Register onRegister={handleRegister} />\n          </Route>\n          {/* <Route>\n            {loggedIn ? <Redirect to=\"/\" /> : <Redirect to=\"/sign-in\" />}\n          </Route> */}\n          <Route path=\"*\">\n            <PageNotFound />\n          </Route>\n        </Switch>\n\n        <Footer />\n\n        <EditProfilePopup\n          isOpen={isEditProfilePopupOpen}\n          onClose={closeAllPopups}\n          onUpdateUser={handleUpdateUser}\n          isLoadingPopup={isLoadingPopup}\n        ></EditProfilePopup>\n        <EditAvatarPopup\n          isOpen={isEditAvatarPopupOpen}\n          onClose={closeAllPopups}\n          onUpdateAvatar={handleUpdateAvatar}\n          isLoadingPopup={isLoadingPopup}\n        ></EditAvatarPopup>\n        <AddPlacePopup\n          isOpen={isAddPlacePopupOpen}\n          onClose={closeAllPopups}\n          onAddPlace={handleAddPlaceSubmit}\n          isLoadingPopup={isLoadingPopup}\n        ></AddPlacePopup>\n\n        <Confirm\n          isOpen={isConfirmOpen}\n          setIsOpen={setConfirmOpen}\n          confirmAction={confirmAction}\n          setСurrentUser={setСurrentUser}\n          isLoadingConfirm={isLoadingConfirm}\n          setIsLoadingConfirm={setIsLoadingConfirm}\n          cardDelete={cardDelete}\n        />\n        <ImagePopup\n          card={selectedCard}\n          isOpen={isImagePopupOpen}\n          onClose={closeAllPopups}\n        />\n        <InfoTooltip\n          isOpen={isInfoTooltipOpen}\n          onClose={closeAllPopups}\n          isConfirmAuth={isConfirmAuth}\n        />\n      </div>\n    </CurrentUserContext.Provider>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}